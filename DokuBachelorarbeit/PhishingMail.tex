%Kapitel der Umsetzung

\chapter{Erstellung einer Phishing-Mail}  %Name des Kapitels
\label{cha:ErstellungeinerPhishing-Mail} %Label des Kapitels
In diesem Kapitel wird die Umsetzung zur Erstellung einer Phishing-Mail beschrieben.

\section{Implementierung der Methode zur Generierung der E-Mail-Adressen}	
Für den den zu entwickelnden Algorithmus wird eine eigene Klasse erstellt. Diese Klasse ist ausschließlich für die Generierung der E-Mail-Adressen zuständig.
	\subsection{Funktion des eigenen Algorithmus}
	Der lokale Teil einer E-Mail-Adresse befindet sich vor dem At-Zeichen. Dieser kann aus verschiedensten Daten bestehen. Allerdings wird in den meisten Fällen der bürgerlichen Namen verwendet. \cite{NameAlsEMail} Aus diesem Grund verwendet der Algorithmus die Personenattribute Vorname, Nachname und das Geburtsjahr.\\
	Im ersten Schritt wird kontrolliert, welche Daten bekannt sind. Im Idealfall sind das alle drei Attribute. Im zweiten Schritt wird festgelegt aus welchen Daten der lokale Teil bestehen kann. Im Folgenden sind möglichen Kombinationen aufgezeigt.
	
	\textit{Vorname;}\\
	\textit{Nachname;}\\
	\textit{Vorname, Nachname;}\\
	\textit{Vorname, Nachname, vollständiges Geburtsjahr;}\\
	\textit{Vorname, Nachname, Kurzform von Geburtsjahr;}
	
	Ein lokaler Teil kann somit aus mehreren Daten bestehen. Es kann vorkommen, dass anstatt "'Max Mustermann"' "'Mustermann Max"' als lokaler Namen verwendet wird. Aus diesem Grund wir für jeden lokalen Teil, der aus mehreren Daten besteht, eine Permutation ohne Wiederholung angewendet. Dadurch werden alle möglichen Kombinationen aus den Daten gewonnen, da bei der Zusammensetzung der Daten zusätzlich auf die Reihenfolge geachtet wird. Außerdem werden bei der Zusammensetzung der Daten die bekannten Trennzeichen "'."',"'\_"' und "'-"' hinzugefügt. Jedoch gibt es ebenfalls jede Kombination ohne Trennzeichen. Die lokale Namen werden anschließend in einer Liste gespeichert.\\
	Für den Domainteil werden die bekannte Mailprovider in Deutschland verwendet.  Dazu gehören die Provider GMX, WEB.DE, Gmail, T-Online, Freenet und 1\&1.\cite{AnbieterMail}. Das bedeutet, es wird für jeden lokalen Namen eine E-Mail-Adresse mit den jeweiligen Mailprovidern und der Landeskennung "'de"' erzeugt. Die folgende Tabelle  zeigt die erzeugten E-Mail-Adressen des Algorithmus für die Daten "'Marco"', "'Lang"' und "'1995"'. Es sind allerdings nur die Mailadressen für die Provider WEB.DE, Gmail und Freenet aufgelistet.
	
	\begin{center}
		%\begin{table}[h!]
		\scriptsize
		\begin{longtable}{c|c|c}
			\label{EMailAdressen}

			%\centering
			%\scriptsize
			%\begin{tabular}{c|c|c}
				marco@web.de& marco@gmail.com& marco@freenet.de\\ 
				lang@web.de& lang@gmail.com& lang@freenet.de\\
				marcolang@web.de& marcolang@gmail.com& marcolang@freenet.de\\
				marco.lang@web.de& marco.lang@gmail.com& marco.lang@freenet.de\\ 
				marco\_lang@web.de& marco\_lang@gmail.com& marco\_lang@freenet.de\\ 
				marco-lang@web.de& marco-lang@gmail.com& marco-lang@freenet.de\\
				langmarco@web.de& langmarco@gmail.com& langmarco@freenet.de\\
				lang.marco@web.de& lang.marco@gmail.com& lang.marco@freenet.de\\
				lang\_marco@web.de& lang\_marco@gmail.com& lang\_marco@freenet.de\\
				lang-marco@web.de& lang-marco@gmail.com& lang-marco@freenet.de\\
				marcolang1995@web.de& marcolang1995@gmail.com& marcolang1995@freenet.de\\
				marco.lang.1995@web.de& marco.lang.1995@gmail.com& marco.lang.1995@freenet.de\\
				marco\_lang\_1995@web.de& marco\_lang\_1995@gmail.com& marco\_lang\_1995@freenet.de\\
				marco-lang-1995@web.de& marco-lang-1995@gmail.com& marco-lang-1995@freenet.de\\ 
				marco1995lang@web.de& marco1995lang@gmail.com& marco1995lang@freenet.de\\
				marco.1995.lang@web.de& marco.1995.lang@gmail.com& marco.1995.lang@freenet.de\\ 
				marco\_1995\_lang@web.de& marco\_1995\_lang@gmail.com& marco\_1995\_lang@freenet.de\\
				marco-1995-lang@web.de& marco-1995-lang@gmail.com& marco-1995-lang@freenet.de\\
				langmarco1995@web.de& langmarco1995@gmail.com& langmarco1995@freenet.de\\
				lang.marco.1995@web.de& lang.marco.1995@gmail.com& lang.marco.1995@freenet.de\\ 
				lang\_marco\_1995@web.de& lang\_marco\_1995@gmail.com& lang\_marco\_1995@freenet.de\\
				lang-marco-1995@web.de& lang-marco-1995@gmail.com& lang-marco-1995@freenet.de\\
				lang1995marco@web.de& lang1995marco@gmail.com& lang1995marco@freenet.de\\
				lang.1995.marco@web.de& lang.1995.marco@gmail.com& lang.1995.marco@freenet.de\\ 
				lang\_1995\_marco@web.de& lang\_1995\_marco@gmail.com& lang\_1995\_marco@freenet.de\\ 
				lang-1995-marco@web.de& lang-1995-marco@gmail.com& lang-1995-marco@freenet.de\\ 
				1995marcolang@web.de& 1995marcolang@gmail.com& 1995marcolang@freenet.de\\
				1995.marco.lang@web.de& 1995.marco.lang@gmail.com& 1995.marco.lang@freenet.de\\ 
				1995\_marco\_lang@web.de& 1995\_marco\_lang@gmail.com& 1995\_marco\_lang@freenet.de\\ 
				1995-marco-lang@web.de& 1995-marco-lang@gmail.com& 1995-marco-lang@freenet.de\\
				1995langmarco@web.de& 1995langmarco@gmail.com& 1995langmarco@freenet.de\\
				1995.lang.marco@web.de& 1995.lang.marco@gmail.com& 1995.lang.marco@freenet.de\\ 
				1995\_lang\_marco@web.de& 1995\_lang\_marco@gmail.com& 1995\_lang\_marco@freenet.de\\
				1995-lang-marco@web.de& 1995-lang-marco@gmail.com& 1995-lang-marco@freenet.de\\
				marcolang95@web.de& marcolang95@gmail.com& marcolang95@freenet.de\\
				marco.lang.95@web.de& marco.lang.95@gmail.com& marco.lang.95@freenet.de\\ 
				marco\_lang\_95@web.de& marco\_lang\_95@gmail.com& marco\_lang\_95@freenet.de\\ 
				marco-lang-95@web.de& marco-lang-95@gmail.com& marco-lang-95@freenet.de\\ 
				marco95lang@web.de& marco95lang@gmail.com& marco95lang@freenet.de\\ 
				marco.95.lang@web.de& marco.95.lang@gmail.com& marco.95.lang@freenet.de\\ 
				marco\_95\_lang@web.de& marco\_95\_lang@gmail.com& marco\_95\_lang@freenet.de\\
				marco-95-lang@web.de& marco-95-lang@gmail.com& marco-95-lang@freenet.de\\
				langmarco95@web.de& langmarco95@gmail.com& langmarco95@freenet.de\\ 
				lang.marco.95@web.de& lang.marco.95@gmail.com& lang.marco.95@freenet.de\\ 
				lang\_marco\_95@web.de& lang\_marco\_95@gmail.com& lang\_marco\_95@freenet.de\\ 
				lang-marco-95@web.de& lang-marco-95@gmail.com& lang-marco-95@freenet.de\\
				lang95marco@web.de& lang95marco@gmail.com& lang95marco@freenet.de\\
				lang.95.marco@web.de& lang.95.marco@gmail.com& lang.95.marco@freenet.de\\ 
				lang\_95\_marco@web.de& lang\_95\_marco@gmail.com& lang\_95\_marco@freenet.de\\ 
				lang-95-marco@web.de& lang-95-marco@gmail.com& lang-95-marco@freenet.de\\
				95marcolang@web.de& 95marcolang@gmail.com& 95marcolang@freenet.de\\ 
				95.marco.lang@web.de& 95.marco.lang@gmail.com& 95.marco.lang@freenet.de\\ 
				95\_marco\_lang@web.de& 95\_marco\_lang@gmail.com& 95\_marco\_lang@freenet.de\\
				95-marco-lang@web.de& 95-marco-lang@gmail.com& 95-marco-lang@freenet.de\\
				95langmarco@web.de& 95langmarco@gmail.com& 95langmarco@freenet.de\\
				95.lang.marco@web.de& 95.lang.marco@gmail.com& 95.lang.marco@freenet.de\\ 
				95\_lang\_marco@web.de& 95\_lang\_marco@gmail.com& 95\_lang\_marco@freenet.de\\ 
				95-lang-marco@web.de& 95-lang-marco@gmail.com& 95-lang-marco@freenet.de
		%	\end{tabular}
		
		%\end{table}
	\end{longtable}
	\end{center}


\section{Validität der generierten Mail-Adressen prüfen}
	
	\subsection{Methoden zum Prüfen der Validität}
	Die erzeugten Adressen werden anschließend auf Validität geprüft. Hierfür gab es früher eine \textit{VRFY} Anfrage von SMTP. Mit dieser Anfrage konnte eine angegebene E-Mail-Adresse überprüft werden. Allerdings wurde der Dienst von Spammern ausgenutzt und wird dadurch von den meisten SMTP-Servern nicht mehr zu Verfügung gestellt.\cite{balduzzi2010abusing}\\
	Demnach muss die Validität auf einem anderen Weg geprüft werden. Eine Möglichkeit zur Prüfung ist die Verwendung bereitgestellter Webseiten, bei der die zu prüfenden E-Mail-Adresse angegeben werden kann. Eine anschließende Rückmeldung verrät dann, ob die Adresse verwendet wird oder nicht. Eine Webseite dafür wäre "'\textit{https://centralops.net/co/}"'. Als Alternative dazu, ist die Entwicklung eines Skriptes, welches die Validität der Adresse prüft.
	
	Im Fall, dass mehrere Adressen von diesem Adresspool gültig sind, kann nach mit Hilfe dieser Mail-Adressen nach Einträgen im Internet gesucht werden. Wenn es eine Übereinstimmung mit der Zielperson gibt, wird diese E-Mail ausgewählt. Andernfalls wird an jede gültige Adresse eine Phishing-Mail gesendet. 
	
	\subsection{Bewertung: Validität Prüfen}
	Für eine bessere Laufzeit des Programms, wird ein Skript zur Überprüfung der Adressen auf Verfügbarkeit und Gültigkeit, verwendet.	


\section{Implementierung der E-Mail-Muster}
Ein E-Mail-Muster entspricht einem Lückentext, bei dem die entsprechenden Lücken mit den gewonnen Daten ergänzt werden. Die Texte müssen so erstellt werden, dass sie die Zielperson ansprechen. Aus diesem Grund, muss für jede Kombination der gewonnenen Daten ein Muster zur Verfügung stehen. Infolgedessen, stellt sich die Frage, wie die E-Mail-Texte möglichst passend kategorisiert werden können.

	\subsection{Kategorien erstellen}
	Die Muster können in zwei große Kategorien unterteilt werden. Es gibt eine private und eine berufliche Kategorie. Der Unterschied zwischen privat und beruflich, besteht in der Art und Weise wie ein Text geschrieben wird. Genaugenommen bedeutet das, dass ein privates Muster in einer Alltagssprache und ein berufliches in einer formelleren Sprache erstellt wird. Diese beiden Kategorien haben weitere Unterkategorien, welche verschiedene Kombinationen aus den personenbezogenen Daten verwenden.\\
	Um die Kategorie zu erkennen, werden zu beginn Abfragen gestartet. Dadurch wird kontrolliert, welche Daten bekannt sind. Im Fall, dass die Institution oder die Tätigkeit der Zielperson bekannt ist, wird ein berufliches Muster gewählt. Wenn keines dieser Attribute bekannt ist, wird ein privates Muster verwendet.
	
		\subsubsection{Berufliche E-Mail-Muster}
		
			\begin{figure}[h!]
				\fbox{\parbox{\linewidth}{\texttt{SUBJECT:\quad Musterinstitution - Netzwerkänderungen\\\\
							Hallo Herr Mustermann,\\
							wir bauen unsere Netzwerkstruktur um. Bitte registrieren Sie sich unter der folgenden Webseite, damit wir Sie in das neue System aufnehmen können.\\https://badlink.com\\\\Mit freundlichen Grüßen\\\\Ihr IT-Team der Musterinstitution}}}
				\caption{Ein berufliches E-Mail-Muster mit den Personenattributen Nachname und Institution }
			\end{figure}
		
			\begin{figure}[h!]
				\fbox{\parbox{\linewidth}{\texttt{SUBJECT:\quad Feedback zur Ausarbeitung\\\\
							Hallo Herr Professor Mustermann,\\
							wie besprochen befindet sich im Anhang meine vorläufige Ausarbeitung. Könnten Sie diese erneut überprüfen und mir ein Feedback geben?\\\\Mit freundlichen Grüßen\\\\	Max Mustermann}}}
				\caption{Ein berufliches E-Mail-Muster mit dem Personenattribut Nachname und einer festgesetzten Tätigkeit}
			\end{figure}
		
			\begin{figure}[h!]
				\fbox{\parbox{\linewidth}{\texttt{SUBJECT:\quad Mustertätigkeit bei der Musterinstitution\\\\
							Hallo Herr Mustermann,\\
							als Mustertätigkeit bei der Musterinstitution, stehen Ihnen nun alle Möglichkeiten offen. Sehen Sie nun Ihre neuen Möglichkeiten unter folgendem Link an.\\
							https://badlink.com\\\\Mit freundlichen Grüßen\\\\Ihr Team der Musterinstitution}}}
				\caption{Ein berufliches E-Mail-Muster mit den Personenattributen Nachname, Tätigkeit und Institution }
			\end{figure}
			
			\begin{figure}[h!]
				\fbox{\parbox{\linewidth}{\texttt{SUBJECT:\quad \textit{Mustertätigkeit} bei der ZF Friedrichshafen AG gesucht\\\\
							Hallo Herr \textit{Mustermann},\\wir, die ZF Friedrichshafen AG suchen einen kompetenten \textit{Mustertätigkeit}.\\
							Im Anhang befindet sich die Stellenausschreibung mit allen Anforderungen und den vorstellbaren Gehaltsstufen.\\\\\
							Ihr Karriere Team der ZF Friedrichshafen AG}}}
				\caption{Ein berufliches E-Mail-Muster mit den Personenattributen Nachname und Tätigkeit}
			\end{figure}
					
		\subsubsection{Private E-Mail-Muster}
			Im nachfolgenden werden die möglichen E-Mail-Muster für die Kategorie "'privat"' aufgezeigt.
			\begin{figure}[h!]
				\fbox{\parbox{\linewidth}{\texttt{SUBJECT:\quad Fragen bzgl. \textit{Kontaktinformation}\\\\
							Hi \textit{Max},\\ hier ist \textit{Kontaktname}. Bezüglich \textit{Kontaktinformation} hätte ich noch ein paar fragen an dich...\\ Könntest du zufällig in den Anhang schauen und bewerten was ich dazu so rausgesucht habe?\\Vielen Danke im Voraus!\\\\\textit{Kontaktname}}}}
			\caption{Ein privates E-Mail-Muster mit den Personenattributen Vorname, Kontaktname und Kontaktinformation}
			\end{figure}
			
			\begin{figure}[h!]
				\fbox{\parbox{\linewidth}{\texttt{SUBJECT:\quad Verbessere deine Technik im \textit{Musterhobby}\\\\
							Hi \textit{Max},\\ damit du deine Leistung im \textit{Musterhobby} verbessern kannst, musst du unbedingt die Techniken deiner Vorbilder anschauen!\\Im Anhang befindet sich darüber eine kleine Übersicht.\\\\Dein Team der deutschen Förderung}}}
				\caption{Ein privates E-Mail-Muster mit den Personenattributen Vorname und Hobby}
			\end{figure}
		
			\begin{figure}[h!]
				\fbox{\parbox{\linewidth}{\texttt{SUBJECT:\quad Jahrgang \textit{Geburtsjahr}\\\\
							Hi \textit{Max},\\dieses Jahr findet ein Treffen für alle Personen, die \text{Geburtsjahr} geboren sind, statt.\\Im Anhang befindet sich eine Liste mit den Leuten die bereits zugesagt haben.\\\\Dein Orga-Team}}}
				\caption{Ein privates E-Mail-Muster mit den Personenattributen Vorname und Jahrgang}
			\end{figure}
		
			\begin{figure}[h!]
				\fbox{\parbox{\linewidth}{\texttt{SUBJECT:\quad Streetfood-Festival in \textit{Musterort}\\\\
							Hi \textit{Max},\\dieses Jahr findet das erste STREETFOOD-FESTIVAL in \textit{Musterort} statt. Im Anhang befindet sich der Plan, auf dem alles weitere erklärt wird.\\
							Wir freuen uns auf dich!\\\\Dein Streefood-Team aus \textit{Musterort}}}}
				\caption{Ein privates E-Mail-Muster mit den Personenattributen Vorname und Jahrgang}
			\end{figure}
		
		\FloatBarrier
\section{Versenden einer Phishing-E-Mail}

	